document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("searchInput"),t=document.getElementById("categoryFilter"),n=document.getElementById("toolsList"),o=document.getElementById("pagination"),i=document.getElementById("bookmarksList"),a=document.getElementById("languageSelect"),r=document.getElementById("toolName"),s=document.getElementById("toolDesc"),l=document.getElementById("toolCategory"),c=document.getElementById("toolUrl"),d=document.getElementById("captchaInput"),m=document.getElementById("captchaText"),u=document.getElementById("refreshCaptcha"),p=document.getElementById("submitToolBtn"),f=document.getElementById("submitStatus"),g=document.getElementById("reviewTool"),h=document.getElementById("reviewText"),v=document.getElementById("reviewRating"),b=document.getElementById("submitReviewBtn"),y=document.getElementById("reviewsList");let w=[],k=1,x=5,L=localStorage.getItem("reviews")?JSON.parse(localStorage.getItem("reviews")):[],S=localStorage.getItem("submittedTools")?JSON.parse(localStorage.getItem("submittedTools")):[];fetch("tools.json").then(e=>{if(!e.ok)throw new Error("Gagal memuat tools.json");return e.json()}).then(e=>{w=[...e,...S];const t=new Set(w.map(e=>e.category));t.forEach(e=>{const n=document.createElement("option");n.value=e,n.textContent=e,t.appendChild(n)}),fetch("languages.json").then(e=>e.json()).then(e=>{a.addEventListener("change",t=>{const n=e[t.target.value];document.getElementById("heroText").textContent=n.hero,document.getElementById("taglineText").textContent=n.tagline,document.getElementById("statsText").textContent=n.stats,document.getElementById("rankText").textContent=n.rank,document.getElementById("spotlightText").textContent=n.spotlight,document.getElementById("featuredBtnText").textContent=n.featuredBtn,document.getElementById("releasedText").textContent=n.released,document.getElementById("bookmarksTitle").textContent=n.bookmarks,document.getElementById("submitToolTitle").textContent=n.submitTool,document.getElementById("reviewsTitle").textContent=n.reviews,document.getElementById("tutorialLink").textContent=n.tutorial,document.getElementById("modeText").textContent=n.mode}),a.dispatchEvent(new Event("change"))}),C()}).catch(e=>{n.innerHTML='<p class="error">Error: Gagal memuat data alat AI.</p>',console.error(e)});function C(){n.innerHTML="",i.innerHTML="";const e=E(),t=w.filter(e=>!t.value||e.category===t.value).filter(e=>e.name.toLowerCase().includes(E().toLowerCase())||e.description.toLowerCase().includes(E().toLowerCase())||e.tags.some(t=>t.toLowerCase().includes(E().toLowerCase()))),o=Math.ceil(t.length/x);let a=(k-1)*x,r=a+x>r*t.length?t.length:a+x;t.slice(a,r).forEach(e=>{const t=document.createElement("div");t.classList.add("tool-card");const o=localStorage.getElementById("bookmarks")?.split(",").includes(e.id);t.innerHTML=`<img src="${e.logo}" alt="${e.name} Icon" class="tool-thumbnail"><span class="tool-name">${e.name}</span><span class="tool-category">${e.category}</span><span class="tool-date">${e.date_added}</span><div class="rating">${"â˜…".repeat(Math.floor(e.popularity)).padEnd(5,"â˜†")}</div><a href="${e.url}" target="_blank" class="tool-link">ğŸŒ</a><span class="tool-check ${o?"tool-bookmark":""}" data-id="${e.id}">${o?"â­":"âœ…"}</span>`,e.tags.forEach(e=>{const n=document.createElement("span");n.classList.add("tool-tag"),n.textContent=e,t.appendChild(n)}),t.querySelector(".tool-check").addEventListener("click",()=>{!o&&T(e.id)}),t.innerHTML+=`<div class="social-share"><a href="https://twitter.com/share?url=https://vinnesia.github.io/VinAI/&text=${encodeURIComponent(e.name)}" target="_blank">Twitter</a><a href="https://www.facebook.com/sharer/sharer.php?u=https://vinnesia.github.io/VinAI/" target="_blank">Facebook</a><a href="https://www.linkedin.com/shareArticle?url=https://vinnesia.github.io/VinAI/&title=${encodeURIComponent(e.name)}" target="_blank">LinkedIn</a></div>`,n.appendChild(t)});const r=localStorage.getItem("bookmarks")?.split(",").filter(e=>e).map(e=>w.find(t=>t.id===e));r.forEach(e=>{const t=document.createElement("div");t.classList.add("tool-card"),t.innerHTML=`<img src="${e.logo}" alt="${e.name} Icon" class="tool-thumbnail"><span class="tool-name">${e.name}</span><span class="tool-category">${e.category}</span><span class="tool-date">${e.date_added}</span><div class="rating">${"â˜…".repeat(Math.floor(e.popularity)).padEnd(5,"â˜†")}</div><a href="${e.url}" target="_blank" class="tool-link">ğŸŒ</a><span class="tool-check tool-bookmark">â­</span>`,e.tags.forEach(e=>{const n=document.createElement("span");n.classList.add("tool-tag"),n.textContent=e,t.appendChild(n)}),i.appendChild(t)}),o.innerHTML="",Array.from({length:o},(e,t)=>t+1).forEach(e=>{const t=document.createElement("button");t.textContent=e,t.addEventListener("click",()=>{k=e>1?e:1,C()}),o.appendChild(t)}),k>1&&o.firstChild.classList.add("active"),y.innerHTML="",L.forEach(e=>{const t=document.createElement("div");t.classList.add("review-card"),t.innerHTML=`<p><strong>${e.tool}</strong> - ${e.review} (${e.rating}/5)</p>`,y.appendChild(t)}),Notification.requestPermission().then(e=>{"granted"===e&&new Notification("New Tool Added!",{body:"Check out the latest AI tools on ToolVerse Nesia AI."})})}function E(){return e.value||""}e.addEventListener("input",C),t.addEventListener("change",C),u.addEventListener("click",()=>{m.textContent=Math.random().toString(36).substring(2,8).toUpperCase()}),p.addEventListener("click",()=>{const e=m.textContent;if(d.value===e&&r.value&&s.value&&l.value&&c.value){const e={id:`sub_${Date.now()}`,name:r.value,description:s.value,category:l.value,url:c.value,logo:"logo.png",tags:[l.value],date_added:new Date().toISOString().split("T")[0],popularity:4.0};S.push(e),localStorage.setItem("submittedTools",JSON.stringify(S)),w=[...w,e],f.textContent="Tool submitted successfully!",setTimeout(()=>{f.textContent=""},3e3),r.value="",s.value="",l.value="",c.value="",d.value=""}else f.textContent="CAPTCHA or fields incorrect!"}),b.addEventListener("click",()=>{g.value&&h.value&&v.value&&(L.push({tool:g.value,review:h.value,rating:v.value}),localStorage.setItem("reviews",JSON.stringify(L)),g.value="",h.value="",v.value="",C())});const T=e=>{let t=localStorage.getItem("bookmarks")?.split(",")??[];t.includes(e)?t=t.filter(t=>t!==e):(t.push(e),t=t.filter(e=>e)),localStorage.setItem("bookmarks",t),C()};m.textContent=Math.random().toString(36).substring(2,8).toUpperCase()});
